.IFJcode21

JUMP prec

LABEL _CHR_

PUSHFRAME

    DEFVAR LF@%STR%RET_
    MOVE LF@%STR%RET_ nil@nil

    DEFVAR LF@%STR%PAR1_
    #i : integer
    MOVE LF@%STR%PAR1_ LF@%STRPARAM1%

    DEFVAR LF@_VAR

    #if i == nil
    JUMPIFEQ _ERROR_ LF@%STR%PAR1_ nil@nil

    #if i > 255
    GT LF@_VAR LF@%STR%PAR1_ int@255 

    JUMPIFEQ _RETNIL_ LF@_VAR bool@TRUE

    #if i < 0
    LT LF@_VAR LF@%STR%PAR1_ int@0 

    JUMPIFEQ _RETNIL_ LF@_VAR bool@TRUE

    INT2CHAR LF@_VAR LF@%STR%PAR1_ #string.char(i)
    MOVE LF@%STR%RET_ LF@_VAR

    RETURN #ret string

LABEL _ERROR_
    EXIT int@57

LABEL _RETNIL_
  MOVE LF@%STR%RET_ nil@nil
  RETURN #ret nil

LABEL prec

CREATEFRAME

DEFVAR TF@%STRPARAM1%
MOVE TF@%STRPARAM1% int@256

CALL _CHR_

WRITE TF@%STR%RET_